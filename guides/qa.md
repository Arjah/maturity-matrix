# QA - гайдлайн

- [Ссылка на документы по тестированию](../concepts/pod-disruption-budget.md)
- [И ещё одна ссылка](https://kubernetes.io/docs/tasks/run-application/configure-pdb/)

## Тестирование нового функционала

Это не так сложно - ведь каждый уровень подразумевает получение нового опыта.

#### :star: Уровень 1 
  ```На прод попадают только полностью протестированные задачи. Перед каждым деплоем выполняются все критичные функциональные и интеграционные.```

1. При планировании спринта закладывается время на тестирование задач специалистом по тестированию
2. Перед релизом проводится тестирование критически важного функционала приложения
3. Перед релизом проводится интеграционное тестирование

#### :star2: Уровень 2
  ```На прод попадают только полностью протестированные задачи. Перед каждым деплоем выполняются функциональные, контрактные, интеграционные и E2E-тесты.```

1. Перед релизом специалист по тестированию или автотесты проверяют сборку на интеграционной среде.
2. В состав сборки для тестирования на интеграционной среде попадают только оттестированные задачи.
3. Перед релизом проводится бизнес тестирование задачи, инициатором задачи.
4. По итогам релиза подготавливается тестовая документация для будущих релизов

#### :boom: Уровень 3
  ```--```


## Регрессионное тестирование

#### :star: Уровень 1 
  ```Имеется тест-план с проверкой всех блокирующих и критических тест-кейсов. На основании результатов тестирования по данному тест плану принимается решение о внедрении в ПРОД.```

1. У команды существует набор сценариев для блокирующих и критических тест кейсов которые прогоняются в процессе регресса
2. В процессе прохождения регресса спецалист по тестированию фиксирует найденные ошибки

#### :star2: Уровень 2
  ```Имеются тест-планы для различных видов тестирования: регрессионные, итнтеграционные, контрактные и Е2Е тесты. Данные тест планы всегда актуальны. На основании результатов тестирования по данным тест-планам принимается решение о внедрении в ПРОД.```

1. Тесты разбиты по функциональности и критичности на уровни. 
2. Для каждого типа тестовых сценариев определен тест план, имеется возможность отфильтровать или автоматически запустить опреденные тести или тесты определенной критичности.
3. По итогам релиза, актуализируется тестовая документация(тест-кейсы, тест план).

#### :boom: Уровень 3
  ```Перед каждым деплоем выполняется "умный регресс" (только то, что могло быть задето доработкой + критичные тесты). Критерии попадания тестов в тест-план "умного регресса" зафиксированы, учитывают архитектурные особенности системы, связность кода, покрытие кода тест-кейсами, влияние доработок на клиента.```

1. На основе опыта и экспертизы системы ответственный специалист по тестированию решает, какие тесты попадут в тест-план 
2. Разработчики участвуют в формировании тестового прогона.
3. При запуске автотестов или ручного регресса, составляется автоматический список тестов на основании собранных репозиториев.
 

## Практики Shift-Left тестирования

#### :star: Уровень 1 
  ```Тестирование "в хвосте" цикла разработки.```

1. Задачи тестируются после разработки специалистом по тестированию или другим членом команды выполняющим роль тестировщика.
2. При планировании задачи время на тестирование и доработку не закладывается, а найденные ошибки исправляются в следующем цикле разработки.
3. При таком подходе это еще нельзя характеризовать применением методологии Shift-Left тестирования. Так как она подрузамевает процесс тестирования параллельный разработке.

#### :star2: Уровень 2
  ```Тестирование идет параллельно разработке.```

1. Параллельно процессу разработки пишутся тест кейсы для будущих проверок и автоматизации.
2. Время на тестирование и доработку после контроля качества закладывается в оценку задачи.
3. Задачи тестируются модульно, на dev среде, параллельно разработке других частей релизной версии.

#### :boom: Уровень 3
  ```Тестирование идет на всех этапах SDLC. Тестирование не является "бутылочным горлышком" и не плетется в конце SDLC.```

1. Специалист по контролю качества подключается в момент описания задачи, анализирует необходимые критерии качества для задачи и описывает DoD.
2. После описания задачи тестировщик проверяет требования к задаче и ищет места потенциальных проблем, предлагает пути их устранения.
3. Время на тестирование и доработку после тестирования закладывается в оценку задачи
4. Параллельно процессу разработку, описываются тестовые сценарии, пишутся автотесты и подготавливается среда для нагрузочного тестирования.
5. Автотесты на задачу запускаются в момент сборки, ручное тестирование контролирует их прохождение и фиксирует ошибки для доработки.
 

## Тестовые сценарии команды определены, их выполнение отслеживается (тест менеджмент)

#### :star: Уровень 1 
  ```Полность покрыты тест-кейсами критичные сценарии. Тест-кейсы хранятся в TMS (Allure). Для каждой доработки/поставки формируется прогон (Launch) в TMS(Allure), в котором проставляются результаты прогона всех тест-кейсов.```

1. Определен набор критичных тестовых сценариев и они описаны в TMS 
2. При релизах проводится ручной или автоматизированный прогон критичных кейсов, результаты анализируются
3. Тест-кейсы добавляются по мере выявления новых, критичных функциональностей.
4. Старые тестовые сценарии актуализируются по мере необходимости

#### :star2: Уровень 2
  ```Покрыты тест-кейсами как минимум все критичные сценарии и тесты 1 и 2 приоритета. В тест-кейсах можно проследить связь с задачами/функционалом/требованиями, для которых написан тест-кейс.```

1. Ведется систематическая работа по актуализации и добавлению тестовых сценариев.
2. Существует RoadMap с планом покрытия фукциональности тестовыми сценариями.
3. Тестовые сценарии имею критичность и у них установлен приоритет на порядок автоматизации.
4. В TMS настроена интеграция с системой управления проектами, для отслеживания покрытия нового функционала тест-кейсами

#### :boom: Уровень 3
  ```Не менее 80% тест-кейсов актуализированны и применяются в тестировании.```

1. Вся основная функциональность система покрыта тест-кейсами
2. Новые тест-кейсы добавляются параллельно разработке
3. При выпуске новой версии выполняется полная проверка всей функциональности системы, соответственно тест-кейсам
 

## Покрытие автотестами

#### :star: Уровень 1 
  ```Покрыты автотестами все критичные тест-кейсы.```

1. Определен набор тестовых сценариев.
2. Определен приоритет тестовых сценариев.
3. Определены критерии для нахождения критичных тестовых сценариев.
4. Покрыты все критичные сценарии автотестами.

#### :star2: Уровень 2
  ```Покрыты автотестами все критичные тест-кейсы, а также все тест-кейсы 1 приоритета. (Суммарное покрытие не менее 60%)```

1. Определены критерии для тест кейсов попадающих под автоматизацию.
2. Определены критерии для приоритезации тестовых сценариев.
3. Определен набор тестовых сценариев 1 приоритета.
4. Покрыты все тест-кейсы 1 приоритета автотестами.
5. Суммарное покрытие не менее 60% от всего набора тестовых сценариев.

#### :boom: Уровень 3
  ```Покрыты автотестами все критичные тест-кейсы, а также все тест-кейсы 1 и 2 приоритета. (Суммарное покрытие не менее 80%)```

1. Определен набор тестовых сценариев 2 приоритета.
2. Покрыты все тест-кейсы 2 приоритета автотестами.
3. Суммарное покрытие не менее 80% от всего набора тестовых сценариев.
 

## Интеграция автотестов в процесс CI/CD

#### :star: Уровень 1 
  ```Автотесты в команде существуют и запускаются вручную. Используются каждый релиз для контроля качества.```

1. Набор автотестов запускается вручную для проверки релиза.
2. Результат прогона анализируется.

#### :star2: Уровень 2
  ```Автотесты запускаются в CI, результаты автотестов прогружаются в TMS (Allure)```

1. Автотесты встроены в CI и запускаются при каждой сборке релиза.
2. Результат автотестов прогружается и анализируется в TMS (Allure).

#### :boom: Уровень 3
  ```На каждый Pull-request происходит запуск набора автотестов, который в пределах 30 (в идеале 10) минут дает информацию о качестве pull-request. Невозможно смержить pull-request с упавшими тестами```

1. Автотесты встроены в CI и гоняются перед мерджем ветки разработчика.
2. Для каждого репозитория определен набор сценариев который запускается при сборке.
3. Набор критичных сценариев проходит при сборке не более чем за 15 минут.
3. Упавшие тесты являются блокером для мерджа Pull-request.
 

## Нагрузочное тестирование

#### :star: Уровень 1 
  ```Нагрузочное тестирование проходит минимум 1 раз в год для всех критичных продуктов.```

1. Определены цели нагрузочного тестирования.
(как минимум, тестирование стабильности работы системы на нагрузке с учетом ожидаемого роста бизнеса)
2. Существует профиль нагрузочного тестирования
 (Список бизнес операций и их интенсивность), который актуализируется перед каждой итерацией нагрузочного тестирования.
3. Существуют скрипты нагрузочного тестирования, которые актуализируются каждую итерацию НТ.
4. Perf-среда соответствует проду как по архитектуре, так и по ресурсам
5. Тестовая среда заглушена, заглушки эмулируют как необходимый функционал сторонней системы, так и задержку ответа и Error Rate.
6. Настроен мониторинг стенда НТ и тестируемого продукта.
7. Результаты НТ валидируются с ЦК
8. По результатам нагрузочного тетсирования принимаются решения о доработке продукта.

#### :star2: Уровень 2
  ```Проводится регулярное нагрузочное (не реже раза в квартал) тестирования с целью мониторинга прозводительности критичных продуктов. ```

1. В качестве триггера для проведения НТ служат доработки системы, способные повлиять на производительность, изменения прогноза бизнеса, инциденты на продуктиве, прошествие определенного времени с последнего тестирования. 
2. На основе НТ приниматеся решение о выводе доработок в Прод и/или о дальнейших доработках для повышения производительности системы(если необходимо)
3. Существует постоянный  или поднимающийся по необходимости (в приоритете временный) стенд для проведения НТ, эквивалентный продуктиву (кроме сравнительных тестов производительности).

#### :boom: Уровень 3
  ```Процесс нагрузочного тестрования интегртрован в цикл разработки и поддержки продукта. ```

1. Каждый компонент критичного продукта (например, каждый микросервис) при любой доработке проходит автоматический сравнительный тест производительности. В случае деградации работы компонента больше допустимого, фейлится билд. Зафейленный билд должен быть проанализирован до вывода доработки в прод и на основе данных должно быть принято решение о допустимости вывода задачи в прод.
2. Метрики производительности каждого компонента выводятся на дашборды, возможно проследить историчность данных. Накопленные данные анализируются не реже раза в квартал.
3. Perf-среда создается и гасится "по кнопке". Среда работает только во время проведения НТ, в остальное время она погашена.
 

## Тестирование обеспечено необходимыми тестовыми средами.

#### :star: Уровень 1 
  ```У команды есть тестовая среда Test, которая предназначена только для тестирования (не для разработки). На данной среде выполняются как минимум функциональные и контрактные тесты (среда может быть заглушена). У команды есть тестовая среда Preprod, на которой включены все актуальные интеграции с Preprod других команд (интеграции с Prod и Test других команд недопустимы). На среде Preprod выполняются интеграционные и E2E-тесты, а также UAT(при необходимости). На Preprod попадают только задачи, которые ранее были протестированы на Test(проведены функциональные и контрактные тесты)```

#### :star2: Уровень 2
  ```У команды есть Perf-среда для критичных продуктов, предназначенная для проведения НТ. Данная среда полностью соответствует проду (как по архитектуре, так и по ресурсам). Тестовая среда заглушена, заглушки эмудируют как необходимый функционал сторонней системы, так и задержку ответа и Error Rate```

#### :boom: Уровень 3
  ```Perf-среда создается и гасится "по кнопке". Среда работает только во время проведения НТ, в остальное время она погашена.```


## Команда умеет оценивать качество своего продукта и процессов

#### :star: Уровень 1 
  ```Собирает базовые метрики качества, их ревью нерегулярное.```

1. Команда тестирования и руководитель проекта понимают для чего нужны метрики качества.
2. Базовые метрики качества определены и зафиксированы.
3. Для пересмотра и актуализации метрик иногда собирается аналитика.

#### :star2: Уровень 2
  ```У команды есть базовые метрики качества продукта, они анализируются регулярно. Есть расширенные метрики для определения корневых проблем и кастомные метрики под нужны команды.```

1. Определен необходимый перечень метрик качества их характеристики и значения.
2. Метрики анализируются и пересматриваются по необходимости.
3. При необходимости метрики могут быть дополнены или изменены.
4. Существуют метрики характеризующие определенный продукт и для них определены критерии качества.

#### :boom: Уровень 3
  ```Есть процесс пересмотра самих метрик, устанавливаются стандарты качества. Метрики качества постоянно улучшаются.```

1. Вся продуктовая команда понимает необходимость описания метрик и их характеристики.
2. Аналитика собирается на регулярной основе и влияет на значение метрик качества.
3. Метрики пересматриваются на регулярной основе и характеризуют качество продукта.
 
